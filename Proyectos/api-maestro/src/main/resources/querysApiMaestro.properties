sql.sostenedorPorRut = SELECT s.rut_sostenedor AS rutSostenedor, s.nombre_sostenedor AS nombreSostenedor, s.telefono_fijo AS telefonoFijo, s.telefono_movil AS telefonoMovil, s.email AS email, s.email_dos AS emailDos, s.email_tres AS emailTres, s.direccion AS direccion, s.numero AS numero, (SELECT nombre FROM info.region WHERE id_region = s.id_region) AS idRegionGlosa, (SELECT nombre FROM info.comuna WHERE id_comuna = s.id_comuna) AS idComunaGlosa, s.vigente AS vigente, s.fecha_creacion AS fechaCreacion, s.fecha_modificacion AS fechaModificacion, (SELECT (nombres || ' ' || paterno) FROM info.usuario WHERE id_usuario = s.usuario_creador) AS usuarioCreador, fuente AS fuente FROM info.sostenedor s WHERE s.rut_sostenedor = :#rutSostenedor::integer AND s.vigente = 1
sql.representantesPorRutSostenedor = SELECT rut_representante AS rutRepresentante, dv_representante AS dvRepresentante, rut_sostenedor AS rutSostenedor, nombre_representante AS nombreRepresentante, paterno_representante AS paternoRepresentante, materno_representante AS maternoRepresentante FROM info.representante_legal WHERE rut_sostenedor = :#rutSostenedor::integer AND vigente = 1
sql.establecimientosPorRbd = SELECT e.rbd AS rbd, e.nombre_esta AS nombreEsta,(SELECT nombre FROM info.region WHERE id_region = e.id_region) AS idRegionGlosa,(SELECT descripcion FROM info.dependencia WHERE id_dependencia = e.id_dependencia) AS idDependenciaGlosa,(SELECT nombre FROM info.provincia WHERE id_provincia = e.id_provincia) AS idProvinciaGlosa,(SELECT (rut_sostenedor || ' - ' || nombre_sostenedor) FROM info.sostenedor WHERE rut_sostenedor = e.rut_sostenedor) AS idSostenedorGlosa,(SELECT nombre FROM info.estado WHERE id_estado = e.id_estado) AS idEstadoGlosa,e.direccion_esta AS direccionEsta,(e.telefono_esta_area || '-' || e.telefono_esta) AS telefonoEsta,(SELECT nombre FROM info.comuna WHERE id_comuna = e.id_comuna) AS idComunaGlosa,e.mail_esta AS emailEsta,(CASE e.ruralidad WHEN '0' THEN 'URBANO' ELSE 'RURAL' END) AS ruralidad,(CASE e.convenio_sep WHEN '0' THEN 'NO' ELSE 'SI' END) AS convenioSEP,(CASE e.convenio_pie WHEN '0' THEN 'NO' ELSE 'SI' END) AS convenioPIE,e.software_propio AS softwarePropio,e.clasificacion_sep AS clasificacionSEP,e.vigente AS vigente,e.fecha_creacion AS fechaCreacion,(SELECT (nombres || ' ' || paterno) FROM info.usuario WHERE id_usuario = e.usuario_creador) AS usuarioCreador,e.fuente AS fuente FROM info.establecimiento e WHERE e.rbd = :#rbd::integer AND e.vigente = 1
sql.establecimientosPorRutSostenedor = SELECT e.rbd AS rbd,e.nombre_esta AS nombreEsta,(CASE e.convenio_sep WHEN '0' THEN 'NO' ELSE 'SI' END) AS convenioSEP,(CASE e.convenio_pie WHEN '0' THEN 'NO' ELSE 'SI' END) AS convenioPIE,(SELECT nombre FROM info.estado WHERE id_estado = e.id_estado) AS idEstadoGlosa,(SELECT descripcion FROM info.dependencia WHERE id_dependencia = e.id_dependencia) AS idDependenciaGlosa,(e.telefono_esta_area || '-' || e.telefono_esta) AS telefonoEsta FROM info.establecimiento e WHERE e.vigente = 1 AND e.rut_sostenedor = :#rutSostenedor::integer