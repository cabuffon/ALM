sql.respuesta = SELECT COALESCE((    SELECT TOP 1 (CASE IIF(Sanc_1 > 0, 'Multa', '-') WHEN '-' THEN '' ELSE IIF(Sanc_1 > 0, 'Multa', '-') + ',' END) + (CASE IIF(Sanc_2 > 0, 'Revocación RO', '-') WHEN '-' THEN '' ELSE IIF(Sanc_2 > 0, 'Revocación RO', '-') + ',' END) + (CASE IIF(Sanc_3 > 0, 'Privación de la Subvención', '-') WHEN '-' THEN '' ELSE IIF(Sanc_3 > 0, 'Privación de la Subvención', '-') + ',' END) + (CASE IIF(Sanc_4 > 0, 'Suspención de la Subvención', '-') WHEN '-' THEN '' ELSE IIF(Sanc_4 > 0, 'Suspención de la Subvención', '-') + ',' END) + (CASE IIF(Sanc_5 > 0, 'Inhabilidad de Sostenedor', '-') WHEN '-' THEN '' ELSE IIF(Sanc_5 > 0, 'Inhabilidad de Sostenedor', '-') + ',' END) + (CASE IIF(Sanc_6 > 0, 'Sobreseído', '-') WHEN '-' THEN '' ELSE IIF(Sanc_6 > 0, 'Sobreseído', '-') + ',' END) + (CASE IIF(Sanc_7 > 0, 'Reintegro', '-') WHEN '-' THEN '' ELSE IIF(Sanc_7 > 0, 'Reintegro', '-') + ',' END) + (CASE IIF(Sanc_8 > 0, 'Amonestación', '-') WHEN '-' THEN '' ELSE IIF(Sanc_8 > 0, 'Amonestación', '-') + ',' END) + (CASE IIF(Sanc_9 > 0, 'Multa ley 20.529', '-') WHEN '-' THEN '' ELSE IIF(Sanc_9 > 0, 'Multa ley 20.529', '-') END) FROM [dbo].[009_Sanciones] WHERE ID_Acta = [dbo].[003_Acta].ID AND ELI = 0 AND Estado_Proceso = 31),'---') AS SancionEnLaCorte, COALESCE( (SELECT TOP 1 MontoLey20529 FROM [dbo].[009_Sanciones] WHERE ID_Acta = [dbo].[003_Acta].ID AND ELI = 0 AND Estado_Proceso = 31 AND ID = (SELECT MAX(ID) FROM [dbo].[009_Sanciones] WHERE ELI = 0 AND Estado_Proceso = 31 AND ID_Acta = [dbo].[003_Acta].ID) ), 0) AS MontoMulta20529, COALESCE( (SELECT TOP 1 Reintegro FROM [dbo].[009_Sanciones] WHERE ID_Acta = [dbo].[003_Acta].ID AND ELI = 0 AND Estado_Proceso = 31 AND ID = (SELECT MAX(ID) FROM [dbo].[009_Sanciones] WHERE ELI = 0 AND Estado_Proceso = 31 AND ID_Acta = [dbo].[003_Acta].ID) ), 0) AS MontoReintegro FROM dbo.[003_Acta] INNER JOIN dbo.[001_Usuario] ON dbo.[003_Acta].ID_Usuario = dbo.[001_Usuario].ID INNER JOIN dbo.[Actas] ON dbo.[003_Acta].Numero = dbo.[Actas].NumeroActa WHERE (dbo.[Actas].FechaIngreso BETWEEN '2014-01-01' AND '2016-12-31') AND (dbo.[Actas].FechaInicioVisita BETWEEN '2014-01-01' AND '2016-12-31') AND (dbo.[Actas].Eliminado = 0) AND (dbo.[003_Acta].Eli = 0) AND (dbo.[003_Acta].ID_Usuario = dbo.[Actas].ID_Usuario) AND '---' <> ( SELECT (CASE WHEN cantidadC > 0 AND cantidadB > 0 THEN 'CON OBSERVACIONES' WHEN cantidadC > 0 AND cantidadB = 0 THEN 'CON OBSERVACIONES' WHEN cantidadC = 0 AND cantidadB > 0 THEN 'B' ELSE '---' END) AS tipoCodigo FROM ( SELECT ((LEN(CONVERT(VARCHAR, Codigos)) - DATALENGTH(REPLACE(CONVERT(VARCHAR, Codigos), 'C', ''))) / LEN('C')) AS cantidadC, ((LEN(CONVERT(VARCHAR, Codigos)) - DATALENGTH(REPLACE(CONVERT(VARCHAR, Codigos), 'B', ''))) / LEN('B')) AS cantidadB FROM ( SELECT STUFF( (SELECT ', ' + CAST(DC.TipoCodigo AS VARCHAR(1)) FROM [dbo].[CodigosActas] DCA, [dbo].[Codigos] DC WHERE DCA.id_Codigo = DC.id_Codigo AND DCA.idActa = dbo.[Actas].idActa FOR XML PATH ('')) , 1, 1, '') AS Codigos ) T) Q ) AND dbo.[Actas].NumeroActa = :#numeroActa